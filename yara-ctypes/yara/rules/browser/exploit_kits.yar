
rule sakura_bin : exploit_kit
{
    strings:
        $a = /\/[0-9]{4}\.html/
        $b = /Host:.*?:8/
    condition:
        2 of ($a,$b)
}

rule neutrino_V2_bin : exploit_kit
{
    strings:
        $a = /\/[a-zA-Z0-9]{55,62}\={1,2}/
        $b = "Java/1"
    condition:
        $a and $b
}

rule safepack_bin : exploit_kit
{
    strings:
        $a = "load.php?e="
	$b = "&ip="
    condition:
        2 of ($a,$b)
}

rule safepack_jar : exploit_kit
{
    strings:
        $a = /\/j\d{2}\.php\?i\=[a-zA-Z0-9]{9,15}/
    condition:
        $a
}

rule Gondad_jar : exploit_kit
{
    strings:
        $a = "PK"
	$b = "GondadGondad"
    condition:
        $a and $b
}


rule sweetorange_entry : exploit_kit
{
    strings:
        $a = "archive="
        $b = "sdj1"
    condition:
        $a and $b
}

rule sweetorange_jar : exploit_kit
{
    strings:
        $a = /\/(mcINkf|YZjcS|tUaZFs)/
    condition:
        $a
}

rule srun_bin : exploit_kit
{
    strings:
        $a = /get\?src\=/
	$b = "Request: srun"
    condition:
        $a or $b
}

rule neutrino_bin : exploit_kit
{
    strings:
        $a = /\/[a-z]{4,15}\?[a-z]{4,7}\=[a-f0-9]{24}/
    condition:
        $a
}

rule bleedinglife : exploit_kit
{
    strings:
        $a = /\.php\?e\=(Adobe-|Java-SPLOIT)/
    condition:
        $a
}

rule blackhole : exploit_kit
{
    strings:
        $a = /\.php\?.*?\:[a-zA-Z0-9\:]{6,}\&.*?\&/
    condition:
        $a
}


rule crimeboss_entry : exploit_kit
{
    strings:
        $a = /\.php\?x\=s\&\w+\=\d+\&no\=\d/
    condition:
        $a
}

rule crimeboss_jar : exploit_kit
{
    strings:
        $a = /\/[a-z0-9]{3,4}\.jar\?r\=\d{6}\s/
    condition:
        $a
}

rule critxpack_jar : exploit_kit
{
    strings:
        $a = /\/j[\d]{2}\.php\?i\=[A-Za-z0-9]{72,}\s/
    condition:
        $a
}

rule critxpack_bin : exploit_kit
{
    strings:
        $a = /load.php\?e\=[a-f0-9\%]{12,16}\&jquery\=[a-f0-9\%]{12,35}\&/
    condition:
        $a
}

rule sofosFO_bin : exploit_kit
{
    strings:
        $a = /\/[a-zA-Z0-9]{24,}\/[0-9]{9,10}\/[0-9]{7,10}\s/
    condition:
        $a
}

rule sofosFO_redirect : exploit_kit
{
    strings:
        $a = /\.php\?id\=\d+\&session\=[a-z0-9]{15,}\&ip\=\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/
    condition:
        $a
}

rule whitehole_jar : exploit_kit
{
    strings:
        $a = /\/Java(\d+.|.)jar\?java\=\d{2,3}/
    condition:
        $a
}

rule kein_bin : exploit_kit
{
    strings:
        $a = /\/\?[A-Za-z0-9]{2,10}\=[a-z0-9%]{70,}\&t\=\d+/
    condition:
        $a
}

rule reddot_bin : exploit_kit
{
    strings:
        $a = /\?guid\=[a-zA-Z0-9]{32}\&thread\=\w+\&exploit\=\d+\&\;version\=[\d._]/
    condition:
        $a
}

rule fiesta_bin : exploit_kit
{
    strings:
        $a = /\/\?[A-Za-z0-9]{55,70}\;\d+\;\d+/
    condition:
        $a
}

rule fiesta_enum : exploit_kit
{
    strings:
        $a = /\/\?[A-Za-z0-9]{50,66}\;\d+\;\d+\;\d+/
    condition:
        $a
}

rule redkit_bin : exploit_kit
{
    strings:
        $a = /\/\d{2}.html\s/
    condition:
        $a
}

rule impact_bin : exploit_kit
{
    strings:
        $a = /\/\w+.php\?\;\d/
    condition:
        $a
}

rule blackhole_bin : exploit_kit
{
    strings:
        $a = /.php\?[a-zA-Z]{2,6}\=[A-Za-z0-9]{10,}\&[A-Za-z]{2,}\=[A-Za-z0-9]{10,}\&[A-Za-z]{1,}\=[A-Fa-f0-9]{2,}\&[A-Za-z]{2,}\=[A-Za-z0-9]+\&[A-Za-z0-9]{1,}\=[A-Za-z]{1,}/
    condition:
        $a
}

rule traffic_broker : tds
{
    strings:
        $a = /rd.php\?http/
    condition:
        $a
}

rule sutra : tds
{
    strings:
        $a = /\/in.cgi\?\d/
    condition:
        $a
}


rule redkit_exploit_fb : exploit_kit
{
        meta:
                author = "X"
                version = "X"
                description = "rule redkit_exploit_fb"

        strings:
                $js3=/\.html\?i=[0-9]{7}/
		$js4=/iframe/
		
        condition:
                $js3 and $js4
}

rule Kelihos_Bot_to_exploit_kit : exploit_kit
{
        meta:
                author = "X"
                version = "X"
                description = "rule Kelihos_Bot_to_exploit_kit "

        strings:
                $js3=/[a-z\.]{11}\/count[0-9]{1,2}.php/ nocase
		
		
        condition:
                $js3
}